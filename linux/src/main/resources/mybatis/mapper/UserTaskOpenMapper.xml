<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.francin.linux.mapper.UserTaskOpenMapper">

    <select id="queryUserTaskOpenListByClassId" resultMap="UserTaskOpen">
        select *
        from user_task_open uto
                 left join task t on uto.task_id = t.id
        where uto.status = 1
    </select>

    <resultMap id="UserTaskOpen" type="UserTaskOpen">
        <id property="id" column="id"/>
        <result property="userId" column="user_id"/>
        <result property="classId" column="class_id"/>
        <result property="taskId" column="task_id"/>
        <result property="taskOrder" column="task_order"/>
        <association property="task" javaType="Task">
            <id property="id" column="task_id"/>
            <result property="taskSn" column="task_sn"/>
            <result property="taskTitle" column="task_title"/>
            <result property="taskDesc" column="task_desc"/>
        </association>
    </resultMap>

    <insert id="addUserTaskOpen" parameterType="UserTaskOpen" useGeneratedKeys="true" keyProperty="id">
        insert into user_task_open(user_id, class_id, task_id, task_order)
        values (#{userId}, #{class_id}, #{taskId}, #{taskOrder})
    </insert>

    <delete id="deleteUserTaskOpen" parameterType="int">
        delete
        user_task where id =
        #{id}
    </delete>
</mapper>